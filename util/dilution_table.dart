class DilutionTable {
  // Assuming a half life of 90 minutes for Levodopa: C = 0.5 ^ (t / 90)
  // (time in minutes) and approximately zero after 10 hours
  static Map<int, double> cByT = {
    0: 1,
    2: 0.984714752934431,
    4: 0.969663144646718,
    6: 0.954841603910417,
    8: 0.940246614086162,
    10: 0.925874712287291,
    12: 0.911722488558217,
    14: 0.897786585065369,
    16: 0.884063695300492,
    18: 0.870550563296124,
    20: 0.857243982853073,
    22: 0.844140796779692,
    24: 0.831237896142788,
    26: 0.818532219529982,
    28: 0.806020752323338,
    30: 0.7937005259841,
    32: 0.781568617348361,
    34: 0.769622147933496,
    36: 0.757858283255199,
    38: 0.746274232154956,
    40: 0.734867246137799,
    42: 0.723634618720189,
    44: 0.712573684787852,
    46: 0.701681819963447,
    48: 0.690956439983888,
    50: 0.680395000087189,
    52: 0.669994994408678,
    54: 0.659753955386447,
    56: 0.649669453175879,
    58: 0.639739095073133,
    60: 0.629960524947437,
    62: 0.62033142268206,
    64: 0.610849503623829,
    66: 0.601512518041058,
    68: 0.592318250589768,
    70: 0.583264519788058,
    72: 0.574349177498518,
    74: 0.565570108418547,
    76: 0.556925229578468,
    78: 0.548412489847313,
    80: 0.540029869446153,
    82: 0.531775379468882,
    84: 0.523647061410313,
    86: 0.515642986701498,
    88: 0.507761256252138,
    90: 0.5,
    92: 0.492357376467216,
    94: 0.484831572323359,
    96: 0.477420801955208,
    98: 0.470123307043081,
    100: 0.462937356143645,
    102: 0.455861244279108,
    104: 0.448893292532685,
    106: 0.442031847650246,
    108: 0.435275281648062,
    110: 0.428621991426536,
    112: 0.422070398389846,
    114: 0.415618948071394,
    116: 0.409266109764991,
    118: 0.403010376161669,
    120: 0.39685026299205,
    122: 0.39078430867418,
    124: 0.384811073966748,
    126: 0.3789291416276,
    128: 0.373137116077478,
    130: 0.3674336230689,
    132: 0.361817309360095,
    134: 0.356286842393926,
    136: 0.350840909981724,
    138: 0.345478219991944,
    140: 0.340197500043594,
    142: 0.334997497204339,
    144: 0.329876977693224,
    146: 0.32483472658794,
    148: 0.319869547536566,
    150: 0.314980262473718,
    152: 0.31016571134103,
    154: 0.305424751811914,
    156: 0.300756259020529,
    158: 0.296159125294884,
    160: 0.291632259894029,
    162: 0.287174588749259,
    164: 0.282785054209273,
    166: 0.278462614789234,
    168: 0.274206244923656,
    170: 0.270014934723077,
    172: 0.265887689734441,
    174: 0.261823530705157,
    176: 0.257821493350749,
    178: 0.253880628126069,
    180: 0.25,
    182: 0.246178688233608,
    184: 0.24241578616168,
    186: 0.238710400977604,
    188: 0.23506165352154,
    190: 0.231468678071823,
    192: 0.227930622139554,
    194: 0.224446646266342,
    196: 0.221015923825123,
    198: 0.217637640824031,
    200: 0.214310995713268,
    202: 0.211035199194923,
    204: 0.207809474035697,
    206: 0.204633054882495,
    208: 0.201505188080834,
    210: 0.198425131496025,
    212: 0.19539215433709,
    214: 0.192405536983374,
    216: 0.1894645708138,
    218: 0.186568558038739,
    220: 0.18371681153445,
    222: 0.180908654680047,
    224: 0.178143421196963,
    226: 0.175420454990862,
    228: 0.172739109995972,
    230: 0.170098750021797,
    232: 0.16749874860217,
    234: 0.164938488846612,
    236: 0.16241736329397,
    238: 0.159934773768283,
    240: 0.157490131236859,
    242: 0.155082855670515,
    244: 0.152712375905957,
    246: 0.150378129510265,
    248: 0.148079562647442,
    250: 0.145816129947015,
    252: 0.143587294374629,
    254: 0.141392527104637,
    256: 0.139231307394617,
    258: 0.137103122461828,
    260: 0.135007467361538,
    262: 0.13294384486722,
    264: 0.130911765352578,
    266: 0.128910746675374,
    268: 0.126940314063034,
    270: 0.125,
    272: 0.123089344116804,
    274: 0.12120789308084,
    276: 0.119355200488802,
    278: 0.11753082676077,
    280: 0.115734339035911,
    282: 0.113965311069777,
    284: 0.112223323133171,
    286: 0.110507961912562,
    288: 0.108818820412016,
    290: 0.107155497856634,
    292: 0.105517599597461,
    294: 0.103904737017848,
    296: 0.102316527441248,
    298: 0.100752594040417,
    300: 0.0992125657480125,
    302: 0.0976960771685451,
    304: 0.096202768491687,
    306: 0.0947322854068999,
    308: 0.0932842790193695,
    310: 0.0918584057672249,
    312: 0.0904543273400236,
    314: 0.0890717105984815,
    316: 0.0877102274954309,
    318: 0.086369554997986,
    320: 0.0850493750108986,
    322: 0.0837493743010848,
    324: 0.0824692444233059,
    326: 0.0812086816469849,
    328: 0.0799673868841416,
    330: 0.0787450656184296,
    332: 0.0775414278352574,
    334: 0.0763561879529786,
    336: 0.0751890647551323,
    338: 0.0740397813237211,
    340: 0.0729080649735073,
    342: 0.0717936471873147,
    344: 0.0706962635523183,
    346: 0.0696156536973086,
    348: 0.0685515612309141,
    350: 0.0675037336807691,
    352: 0.0664719224336102,
    354: 0.0654558826762892,
    356: 0.0644553733376872,
    358: 0.0634701570315172,
    360: 0.0625,
    362: 0.061544672058402,
    364: 0.0606039465404199,
    366: 0.0596776002444011,
    368: 0.0587654133803851,
    370: 0.0578671695179557,
    372: 0.0569826555348885,
    374: 0.0561116615665856,
    376: 0.0552539809562807,
    378: 0.0544094102060078,
    380: 0.0535777489283171,
    382: 0.0527587997987307,
    384: 0.0519523685089242,
    386: 0.0511582637206239,
    388: 0.0503762970202086,
    390: 0.0496062828740062,
    392: 0.0488480385842726,
    394: 0.0481013842458435,
    396: 0.0473661427034499,
    398: 0.0466421395096847,
    400: 0.0459292028836125,
    402: 0.0452271636700118,
    404: 0.0445358552992408,
    406: 0.0438551137477155,
    408: 0.043184777498993,
    410: 0.0425246875054493,
    412: 0.0418746871505424,
    414: 0.041234622211653,
    416: 0.0406043408234925,
    418: 0.0399836934420708,
    420: 0.0393725328092148,
    422: 0.0387707139176287,
    424: 0.0381780939764893,
    426: 0.0375945323775661,
    428: 0.0370198906618605,
    430: 0.0364540324867537,
    432: 0.0358968235936573,
    434: 0.0353481317761592,
    436: 0.0348078268486543,
    438: 0.0342757806154571,
    440: 0.0337518668403846,
    442: 0.0332359612168051,
    444: 0.0327279413381446,
    446: 0.0322276866688436,
    448: 0.0317350785157586,
    450: 0.03125,
    452: 0.030772336029201,
    454: 0.0303019732702099,
    456: 0.0298388001222005,
    458: 0.0293827066901926,
    460: 0.0289335847589778,
    462: 0.0284913277674443,
    464: 0.0280558307832928,
    466: 0.0276269904781404,
    468: 0.0272047051030039,
    470: 0.0267888744641585,
    472: 0.0263793998993654,
    474: 0.0259761842544621,
    476: 0.0255791318603119,
    478: 0.0251881485101043,
    480: 0.0248031414370031,
    482: 0.0244240192921363,
    484: 0.0240506921229218,
    486: 0.023683071351725,
    488: 0.0233210697548424,
    490: 0.0229646014418062,
    492: 0.0226135818350059,
    494: 0.0222679276496204,
    496: 0.0219275568738577,
    498: 0.0215923887494965,
    500: 0.0212623437527246,
    502: 0.0209373435752712,
    504: 0.0206173111058265,
    506: 0.0203021704117462,
    508: 0.0199918467210354,
    510: 0.0196862664046074,
    512: 0.0193853569588144,
    514: 0.0190890469882446,
    516: 0.0187972661887831,
    518: 0.0185099453309303,
    520: 0.0182270162433768,
    522: 0.0179484117968287,
    524: 0.0176740658880796,
    526: 0.0174039134243271,
    528: 0.0171378903077285,
    530: 0.0168759334201923,
    532: 0.0166179806084026,
    534: 0.0163639706690723,
    536: 0.0161138433344218,
    538: 0.0158675392578793,
    540: 0.015625,
    542: 0.0153861680146005,
    544: 0.015150986635105,
    546: 0.0149194000611003,
    548: 0.0146913533450963,
    550: 0.0144667923794889,
    552: 0.0142456638837221,
    554: 0.0140279153916464,
    556: 0.0138134952390702,
    558: 0.0136023525515019,
    560: 0.0133944372320793,
    562: 0.0131896999496827,
    564: 0.0129880921272311,
    566: 0.012789565930156,
    568: 0.0125940742550522,
    570: 0.0124015707185016,
    572: 0.0122120096460681,
    574: 0.0120253460614609,
    576: 0.0118415356758625,
    578: 0.0116605348774212,
    580: 0.0114823007209031,
    582: 0.011306790917503,
    584: 0.0111339638248102,
    586: 0.0109637784369289,
    588: 0.0107961943747483,
    590: 0.0106311718763623,
    592: 0.0104686717876356,
    594: 0.0103086555529132,
    596: 0.0101510852058731,
  };

  static double cAfter(Duration time) {
    return cAfterMinutes(time.inMinutes);
  }

  static double cAfterMinutes(int t) {
    if (t < 0 || t > 615) return 0.0;
    int closestKey = cByT.keys
        .where((key) => key <= t)
        .fold(0, (prev, curr) => curr > prev ? curr : prev);
    return cByT[closestKey]!;
  }
}
